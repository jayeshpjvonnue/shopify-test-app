{% schema %}
{
  "name": "Custom Contact Form",
  "target": "section",
  "settings": []
}
{% endschema %}

<form id="contactForm">
  <input name="name" placeholder="Your name" required>
  <input type="email" name="email" placeholder="Email" required>
  <textarea name="message" placeholder="Message"></textarea>
  <button type="submit">Send</button>
</form>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('contactForm');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const formData = new FormData(form);

      try {
        const res = await fetch('/apps/myapp/contact-action', {
          method: 'POST',
          body: formData,
          headers: {
            'User-Agent': 'my-shopify-app',
          },
        });

        const data = await res.json();

        if (data.success) {
          alert('Customer created successfully!');
          form.reset();
        } else {
          console.error(data);
          alert('Error creating customer: ' + (data.shopifyError?.errors || data.error || JSON.stringify(data)));
        }
      } catch (err) {
        console.error(err);
        alert('Unexpected error: ' + err.message);
      }
    });
  });
</script>

{{ 'contact-form.css' | asset_url | stylesheet_tag }}
